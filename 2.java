Some code changes as well
